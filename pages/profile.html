<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="../Assets/CSS/profile.css" />
  </head>
  <body>
    <!-- <div class="container"> -->

    <form class="profile_form" id="form_p">
      <div class="head_div">
        <h2 class="head">User Profile</h2>
      </div>
      <div class="form-group">
        <label for="email" class="all_label">username:</label>
        <br />
        <br />
        <input type="name" class="form-control personName" id="usernsme" />
      </div>
      <div class="form-group">
        <label for="email" class="all_label">Email:</label>
        <br />
        <br />
        <input type="email" class="form-control personEmail" id="email" />
      </div>
      <div class="form-group">
        <label for="pwd" class="all_label">Password:</label>
        <br />
        <br />
        <input type="text" class="form-control personPassword" id="password" />
      </div>

      <div class="form-group">
        <label for="pwd" class="all_label"> Confirm Password:</label>
        <br />
        <br />
        <input
          type="text"
          class="form-control personcPassword"
          id="c_password"
        />
      </div>

      <div class="form-group">
        <label for="pwd" class="all_label">Phone number:</label>
        <br />
        <br />
        <input type="text" class="form-control personPhone" id="phone" />
      </div>

     
      <div class="submit">
        <button type="submit" class="delete_btn" id="delete_button">
          Delete
        </button>
        <a class="submit_btn" href="./profile_edit.html"> Edit </a>
      </div>
    </form>
    <!-- </div> -->

    <script>
      // JSON

      // java Script

      // get data from local storage
      const thisUser = JSON.parse(localStorage.getItem("this_user"));
      const userInfo = JSON.parse(localStorage.getItem("userinfo"));
      // get object from local storage used by email
      let oneUser = userInfo.find(function (event) {
        let userEmail = event["email"];
        if (thisUser == userEmail) {
          return true;
        }
      });

      const usename = document.querySelector(".personName");
      const useemail = document.querySelector(".personEmail");
      const usePassword = document.querySelector(".personPassword");
      const usecpassword = document.querySelector(".personcPassword");
      const usePhone = document.querySelector(".personPhone");

      usename.value = oneUser["userName"];
      useemail.value = oneUser["email"];
      usePassword.value = oneUser["email_password"];
      usecpassword.value = oneUser["emailc_password"];
      usePhone.value = oneUser["phoneNumber"];

      
      let delete_oneuser = document.getElementById("delete_button");
      delete_oneuser.addEventListener("click", function (event) {
        event.preventDefault();
        let index = userInfo.indexOf(oneUser);
        let msg = confirm("Are you sure you want to delete this account");
        if (msg !== true) {
          return;
        } else {
          userInfo.splice(index, 1);

          localStorage.setItem("userinfo", JSON.stringify(userInfo));
          window.location.href = "../pages/login.html";
        }
      });

      // window.location.href = "../pages/profile_edit.html";
    </script>
  </body>
</html>
